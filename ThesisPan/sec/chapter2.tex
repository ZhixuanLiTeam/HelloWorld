\chapter{预备知识}
在本章节中，我们收集并介绍了本文所涉及的预备知识．
\ref{sec:YinSpace}节介绍了由文献\cite{zhang18:cubicMARS}提出的将殷空间作为空间中流相数学模型的理论，
\ref{sec:simplex}节介绍了单纯复形的相关知识，
\ref{sec:MARS}节介绍了由文献\cite{zhang16:_mars}提出的显示界面追踪的MARS理论框架．


\section{殷空间（Yin space）：三维空间中流相的数学模型}
\label{sec:YinSpace}
在这一部分中，我们收集了数学各个分支上的定义与结果，
提出了一个具有物理意义的连续介质模型.这个建模空间适用于界面追踪的数值分析，
也为今后拓扑变化的处理提供了坚实的基础．
\subsection{布尔代数}
\begin{defn}
	\label{bool algebra}
	$B :=( \mathbb{B},\    \vee,\   \wedge,\   ',\   \hat{0}, \   \hat{1} )$是一个布尔代数，其中$\mathbb{B}$是一个非空子集,$\vee$和$\wedge$是定义在$\mathbb{B}$上的二元运算，$'$是定义在$\mathbb{B}$上的一元运算，对于任意的$x,y,z\in \mathbb{B}$,都满足，
	 \begin{enumerate}[]
	 		\setlength{\itemsep}{0pt}
	 	\setlength{\parsep}{0pt}
	 	\setlength{\parskip}{0pt}
		\item （同一律）%the identity laws: 
		$x\wedge \hat{1} = x$ 且 $x\vee \hat{0}=x$,
		\item （互补律）%the complement laws: 
		$x\wedge x' = \hat{0}$ 且  $x\vee x'=\hat{1}$,
		\item （交换律）%the commutative laws: 
		$x\vee y = y\vee x$ 且
		$x\wedge y = y\wedge x$, 
		\item （分配律）%the distributive laws:
		%    \begin{displaymath}
		%      \label{eq:distributiveLaws}
		$x\wedge (y\vee z) = (x\wedge y)\vee (x\wedge z)$ 且
		%      \qquad
		$x\vee (y\wedge z) = (x\vee y)\wedge (x\vee z)$.
		%    \end{displaymath}
	\end{enumerate}
集合$\mathbb{B}$称为该布尔代数的论域（universe），
布尔代数$B$称为有限布尔代数若其论域$\mathbb{B}$是有限集．
\end{defn}
对于布尔代数的定义还可以包含了更多的定律，
例如狄摩根定律\cite{burris81:_cours_univer_algeb,givant09:_introd_boolean_algeb}，
但是Huntingdun\cite{huntington04:_sets_indep_postul_algeb_logic}证明了，
定义\ref{bool algebra}中的定律构成了布尔代数所满足定律的最小公理集．

抑或运算“$\oplus$”定义如下，
 \begin{equation}
\label{eq:symmetricDifference}
\forall x,y\in {\mathbb B},\qquad 
x \oplus y := (x \wedge y') \vee (x' \wedge y).
\end{equation}

\subsection{正则集合的拓扑空间}
在一个拓扑空间$\mathcal{X}$中，集合$\mathcal{P}\subseteq\mathcal{X}$，
$\mathcal{P}$的补集记为$\mathcal{P}^{\prime}$，
 $\mathcal{P}$是闭集若$\mathcal{P}$的补集是开集．
 $\mathcal{P}$的闭包记为$\mathcal{P}^-$，
 是$\mathcal{P}$的所有闭超集的交．
 $\mathcal{P}$的内部记作$\mathcal{P}^{\circ}$，
 是$\mathcal{P}$的所有开子集的并．
 $\mathcal{P}$的外部
 $\mathcal{P}^{\perp} :=\mathcal{P}^{\prime \circ} :=(\mathcal{P}^{\prime}) ^{\circ}$
 是其补集的内部．
 点$\mathbf{x}\in \mathcal{X}$是一个边界点，
 若$\mathbf{x}\notin \mathcal{P}^{\circ}$且$\mathbf{x}\notin \mathcal{P}^{\perp}$．
 $\mathcal{P}$的边界是$\mathcal{P}$的所有边界点组成的集合，
 记做$\partial \mathcal{P}$．
 另外，
 $\mathcal{P}^{\circ}=\mathcal{P} \backslash \partial \mathcal{P},　 \mathcal{P}^- =\mathcal{P} \cup \partial \mathcal{P}$．


在拓扑空间$\mathcal{X}$中，$\mathcal{P}\subseteq \mathcal{X}$,
称$\mathcal{P}$是一个正则开集，若$\mathcal{P}=\mathcal{P}^{- \circ}$；
称$\mathcal{P}$是一个正则闭集，若$\mathcal{P}=\mathcal{P}^{\circ -}$．
$\mathcal{P}$的闭包$\mathcal{P}^-$就是$\mathcal{P}$的补集内部的补集\cite{ginzburg01:_two_vof}，
即$\mathcal{P}^-=\mathcal{P}^{\prime \circ \prime}$，
由内部运算和闭包运算的对偶性可得，
\begin{equation*}
\begin{array}{rcl}
\mathcal{P}^{\perp}=&\mathcal{P}^{\prime\circ}&=\mathcal{P}^{- \prime},\\
\mathcal{P}^{\circ}=&\mathcal{P}^{\prime \prime \circ \prime\prime}&=\mathcal{P}^{\prime -\prime},
\end{array}
\end{equation*}
再根据定义若$\mathcal{P}$是一个正则开集，则有
\begin{equation*}
\mathcal{P}=\mathcal{P}^{-\circ}=(\mathcal{P}^-)^{\prime -\prime}=\mathcal{P}^{\perp\perp}.
\end{equation*}
因此$\mathcal{P}$是一个正则开集
当且仅当$\mathcal{P}=\mathcal{P}^{\perp \perp} :=(\mathcal{P}^{\perp})^{\perp}$．
故对于任意的$\mathcal{Q}\subseteq \mathcal{X}$, $\mathcal{Q}^{\perp \perp}$ 是一个正则开集，
$\mathcal{Q}^{\circ -}$是一个正则闭集．

\begin{thm}
	\label{thm:boolAlgebra}（MacNeille\cite{macneille37:_partial} and Tarski\cite{tarski37:_ueber_mengen_mengen}）．
	记$\mathbb{B}$是拓扑空间$\mathcal{X}$中所有正则开集的集合，
	并在该集合上定义$\mathcal{P} \cup^{\perp\perp} \mathcal{Q}:= (\mathcal{P}\cup\mathcal{Q})^{\perp\perp}$.
	那么泛代数$B_o :=(\mathbb{B}, \  \cup^{\perp\perp}, \  \cap, \   \perp, \  \emptyset, \  \mathcal{X})$
	是一个布尔代数．
\end{thm}

一个满足连续介质假定的流相不存在低维元素，
例如，三维空间上的孤立点线面．
虽然正则集合（开集或闭集）可以捕捉这一特征，
但其在作为流相数学模型空间时，依然存在着不足．
在数值模拟中，模型的个体数目理应是有限的，
但正则集合可能不满足上述条件．
以下面两个正则开集的交集为例，
\begin{equation*}
\label{eq:pathologicalIntersection}
\left\{
\begin{array}{l}
{\mathcal A}_p := \{(x,y,z)\in \mathbb{R}^3 :
-2< y< \sin\frac{1}{x},\ 
0< x< 1,0<z<1 \},\\
{\mathcal A}_s := \{(x,y,z)\in \mathbb{R}^3 :
0 < y < 1,\ 
-1< x< 1,0<z<1 \}.
\end{array}
\right.
\end{equation*}


虽然$\mathcal{A}_p$和$\mathcal{A}_s$是由两个不等式所描述的，
但是它们的交集是无限数量的正则集的不相交集\cite{requicha77:_mathem_model_rigid_solid_objec}，
也就是说两个正则集的布尔运算产生的结果可能无法用有限个个体数目表示，
因此我们需要寻找一个更合适的正则集的子空间，
其中每一个元素都能被有限个等式或不等式来的描述，
由此我们加入了半解析集（semianalytic sets）的限制．

\subsection{殷空间}
\begin{defn}
	\label{defn:semianalyticSet}
集合$\mathcal{S}　\subseteq \mathbb{R}^{\textup{D}}$
是一个半解析集若存在有限个解析函数
$g_i:\mathbb{R}^{\textup{D}}\rightarrow \mathbb{R}$
使得$\mathcal{S}$是由以下集合构成的有限布尔代数的论域（universe），
\begin{equation}
　　\label{eq:semiAnalyticForm}
{\mathcal X}_i=\left\{\mathbf{x}\in \mathbb{R}^{\textup{D}}:  g_i(\mathbf{x})\ge 0\right\}.
\end{equation}
\end{defn}
其中$g_i$被称为$\mathcal{S}$的生成函数．
特别地，一个半解析集是一个半代数，若其生成函数都是多项式．
我们用$\mathbb{S}^{\textup{D}}$来表示半解析集的拓扑空间．

	
根据定义,半解析集对于求补、有限求交、有限求并等运算都是封闭的．
因此，所有代数和解析变量都是半解析集，因为：
 \begin{equation*}
\left\{\mathbf{x}\in \mathbb{R}^{\textup{D}} : g(\mathbf{x})=0\right\} =
\left\{\mathbf{x}\in \mathbb{R}^{\textup{D}} : g(\mathbf{x})\ge 0\right\}
\cap
\left\{\mathbf{x}\in \mathbb{R}^{\textup{D}} : -g(\mathbf{x})\ge 0\right\}.
\end{equation*}
其中，\eqref{defn:semianalyticSet}中的 “$\ge$” 可替换成 ``$>$''由于
\begin{equation*}
\left\{\mathbf{x}\in \mathbb{R}^{\textup{D}} : g(\mathbf{x})> 0\right\} =
\mathbb{R}^{\textup{D}} \setminus
\left\{\mathbf{x}\in \mathbb{R}^{\textup{D}} : -g(\mathbf{x})\ge 0\right\},
\end{equation*}
因此半解析集合对于拓扑操作也是封闭的．
也就是说，若$\mathcal{S}\subset \mathbb{R}^{\textup{D}}$是半解析的，
则$\mathcal{S}^{\circ}$和$\mathcal{S}^-$也是半解析的．　
\begin{defn}
\label{defn:YinSet}
殷集$\mathcal{Y}\subseteq\mathbb{R}^3$是空间上边界有界的正则半解析开集，
所有这些集合组成殷空间，记为$\mathbb{Y}$.
\end{defn}
由于半解析集合对拓扑操作是封闭的，
因此半解析集合也构成一个布尔代数，
定理\ref{thm:boolAlgebra}就意味着正则半解析开集也构成一个布尔代数，
再由定义\ref{defn:YinSet}可得以下命题，
\begin{prop}
	$Y := ( \mathbb{Y},\   \cup^{\perp \perp},\   \cap,\   \perp,\   \emptyset,\   \mathbb{R}^3)$是一个布尔代数．
\end{prop}
\begin{defn}
定义殷集$\mathcal{S} \in \mathbb{Y}$的体积如下：
 \begin{equation}
\label{eq:volumeOfRegularOpenSet}
\|{\mathcal S}\| := \int_{{\mathcal S}}\mathrm{d} \mathbf{x}.
\end{equation}
\end{defn}
其中这里的积分是黎曼积分，若$\mathcal{S}$是有界的正则集合，
则定义\eqref{eq:volumeOfRegularOpenSet}显然存在，
若$\mathcal{S}$无界，则定义$\|S\|=+\infty$．
\begin{defn}
定义殷空间上的度量$d :\mathbb{Y}\times\mathbb{Y} \rightarrow \mathbb{R}$如下：
 \begin{equation}
\label{eq:MetricOfYinSpace}
%   \forall {\cal S}, {\cal P}\in {\mathbb{Y}},\qquad
d({\cal S},{\cal P}) := \|{\cal S}\oplus {\cal P}\|.
\end{equation}
\end{defn}
这里的度量满足非负性$d({\cal S},{\cal P})\ge 0$,
同一性 $d({\cal S},{\cal S})=0$,
对称性 $d({\cal S},{\cal P})= d({\cal P},{\cal S})$,
三角不等式 
$d({\cal S},{\cal P})\le d({\cal S},{\cal T}) + d({\cal T},{\cal P})$.






\section{单纯复形}
\label{sec:simplex}
在二维的界面追踪过程中，显示边界用直线连接或者由一组多项式曲线表示．
这一节给出了在本文的三维界面追踪中显式界面的表示方法．

\begin{defn}
	以下线性组合称为$n+1$个顶点$X=\{\mathbf{x}_0, \mathbf{x}_1, \cdots, \mathbf{x}_n\}$的仿射组合，
	\begin{equation*}
	\mathbf{y}=\sum_{i=0}^{n}=\lambda_i \mathbf{x}_i, \quad\text{s.t.}\quad \sum_{i=0}^{n}\lambda_i=1.
	\end{equation*}
	$X$的仿射包是其所有点的仿射组合的集合，记为$\text{aff}(X)$或者$\text{aff}\{\mathbf{x}_0, \mathbf{x}_1, \cdots,\mathbf{x}_n\}.$
	\end{defn}

\begin{defn}
	$n+1$个顶点$X=\{\mathbf{x}_0, \mathbf{x}_1,\cdots, \mathbf{x}_n\}$的凸组合是它们的仿射组合，
	且满足每个系数都在$[0,1]$中，也就是
	\begin{equation*}
	\mathbf{y}=\sum_{i=0}^{n}=\lambda_i \mathbf{x}_i, \quad\text{s.t.}\quad \lambda_i\in[0,1], \sum_{i=0}^{n}\lambda_i=1.
	\end{equation*}
	$X$的凸包是其所有凸组合的集合，
	记作$\text{conv}(X)$或$\text{conv}\{\mathbf{x}_0,\mathbf{x}_1,\cdots,\mathbf{x}_n\}$.
	\end{defn}

\begin{defn}
	有序集合$\{x_0, x_1, \cdots ,x_m\}\in \mathbb{R}^{\textup{D}}$是仿射无关的
	当且仅当$\{x_1-x_0, x_2-x_0, \cdots, x_m-x_0 \}$是$\mathbb{R}^{\textup{D}}$的线性无关的子集．
	\end{defn}

\begin{defn}
	令$X=\{\mathbf{x}_0,\mathbf{x}_1, \cdots, \mathbf{x}_m\}$是
	$\mathbb{R}^{\textup{D}}$的仿射无关的子集．
	以$\mathbf{x}_0,\mathbf{x}_1, \cdots, \mathbf{x}_m$为顶点的单形$\mathbf{X}$记为
	\begin{equation*}
	\mathbf{X}=[\mathbf{x}_0,\mathbf{x}_1, \cdots, \mathbf{x}_m]:= \text{conv}\{\mathbf{x}_0, \mathbf{x}_1, \cdots, \mathbf{x}_m\},
	\end{equation*}
	是$X$的凸包．
	\end{defn}

例如：（１）$v_0,v_1$是仿射无关的，当且仅当$v_1-v_0$不为零；
1-单形$[v_0,v_1]$是线段．
（２）$v_0,v_1,v_2$是仿射无关的，当且仅当$v_1-v_0, v_2-v_0$ 不共线；
2-单形$[v_0,v_1,v_2]$是三角形．
（３）$v_0,v_1,v_2,v_3$是仿射无关的，当且仅当$v_1-v_0,v_2-v_0,v_3-v_0$不共面；
3-单形$[v_0,v_1,v_2,v_3]$是四面体．

\begin{defn}
	$m$-单形的顶点集合表示如下,
	\begin{equation*}
	\text{Vert}(\mathbf{X})=X=\{\mathbf{x}_0, \mathbf{x}_1, \cdots, \mathbf{x}_m\}.
	\end{equation*}
	$m$-单形$\mathbf{X}$的维数是$m$，记作$\dim \mathbf{X}.$
	\end{defn}
		

\begin{defn}
	对于$\{0,1,\cdots,k\}$的非空子集$\{j_0,j_1,\cdots,j_h\}$,
	[$\mathbf{x}_{j_0},\mathbf{x}_{j_1},\cdots,\mathbf{x}_{j_h}]$
	称为$k$-单形$[\mathbf{x}_1,\mathbf{x}_2,\cdots,\mathbf{x}_k]$的一个$h$维面，
	其中顶点是$0$维面．
	对于$m$-单形$[\mathbf{x}_0,\mathbf{x}_1,\cdots,\mathbf{x}_m]$，
	其顶点$\mathbf{x}_i$所对应的$(m-1)$维面
	记作$[\mathbf{x}_0,\cdots,\hat{\mathbf{x}}_i,\cdots,\mathbf{x}_m]$，
	是以下集合
	\begin{equation*}
	\{\sum_{j=0}^{m}t_j\mathbf{x}_j : t_j \leq 0, \sum_{j=0}^{m}t_j=1,t_i=0\}.
	\end{equation*}
	$m$-单形的边界是其所有$(m-1)$维面的并集．
\end{defn}


\begin{defn}
	\label{defn:simplex}
	$K$是$\mathbb{R}^{\textup{D}}$中有限个单形的集合，且$K$满足：
	\begin{enumerate}
		\setlength{\itemsep}{0pt}
		\setlength{\parsep}{0pt}
		\setlength{\parskip}{0pt}
		\item 若$\sigma\in K$,则$\sigma$的每一个面都属于$K$;
		\item 若$\sigma,\tau\in K$,则$\sigma \cap \tau $要么是空集，
		要么是$\sigma $和$\tau$的单个公共面.
	\end{enumerate}
		则$K$是一个（有限）单纯复形.
\end{defn}

\begin{defn}
	单纯复形$K$的维数记作$\dim K$，
	\begin{equation*}
		\dim K :=\sup_{\sigma\in K}\{\dim \sigma\}.
	\end{equation*}
	记维数为$n$的单纯复形为$n$-复形．
	\end{defn}

\begin{defn}
	单形$\sigma$的所有面组成一个单纯复形，称为单形$\sigma$的闭包复形．	
\end{defn}
如：2-单形$\sigma=[v_0,v_1,v_2]$的闭包复形为
\begin{equation*}
\{(v_0),(v_1),(v_2),(v_0,v_1),(v_1,v_2),(v_0,v_2),(v_0,v_1,v_2)\}.
\end{equation*}

\begin{defn}
	设$K$是$n$维复形．$K$的一个$r$（$r \leq n$）维骨架是$K$的一个子复形，定义为
	\begin{equation*}
	K^r=\{\sigma \in K:\dim \sigma\leq r\}.
	\end{equation*}
	对于2-单形$s=[v_0,v_1,v_2]$的闭包复形$K$，0维骨架和1维骨架分别为：
	\begin{align*}
	K^0 &=\{[v_0],[v_1],[v_2]\},\\
	K^1 &=\{[v_0],[v_1],[v_2],[v_0,v_1],[v_1,v_2],[v_0,v_2]\}.
	\end{align*}
\end{defn}

\begin{defn}
	设$T$是单纯复形$K$的子单纯复形，$K$中所有与$T$相交的面的集合称作$T$的星形，
	记为$\mathrm{star}(T)$.
\end{defn}

\begin{defn}
	\label{defn:jihezaiti}
	用$[K]$或者$|K|$表示单纯复形$K$中各单形的点集之并，
	\begin{equation*}
	|K|=\cup_{\sigma\in K}\sigma,
	\end{equation*}
	称为复形$K$的几何载体，是$\mathbb{R}^{\textup{D}}$的紧致集．
\end{defn}

\begin{defn}
	称拓扑空间$X$可三角剖分，若其与某一复形$K$的多面体$|K|$同胚．
	若存在复形$K$和同胚$f: |K|\rightarrow X$，
	称$(K,f)$或$K$为$X$的一个三角剖分．	
\end{defn}

例如：球面$S^2$，在$\mathbb{R}^3$中，取3-单形$[v_0,v_1,v_2,v_3]$的闭包复形的2维骨架．

设$v_0,v_1,v_2,v_3$都不为零，将$S^2$取成以原点为心的单位球面，则下列映射是同胚的：
\begin{equation*}
f:|K|\rightarrow S^2,\quad f(v)\triangleq v/\|v\|.
\end{equation*}

在三维界面追踪中，我们要求流相的边界可三角剖分．
为了计算的方便，我们仅记录三角剖分$K$的顶点以及$K$中2-单形的信息即可唯一确定三角剖分$K$.
\begin{defn}
	\label{defn:triangulation}
	定义三角剖分信息如下：
	\begin{enumerate}
		\setlength{\itemsep}{0pt}
		\setlength{\parsep}{0pt}
		\setlength{\parskip}{0pt}
		\item 顶点的个数$n_v$和三角形的个数$n_t$；
		\item $n_v\times 3$的矩阵，其中第$i$个行向量$[x_i,y_i,z_i]$表示第$i$个顶点的空间坐标；
		\item $n_t\times 3$的矩阵，其中第$i$行的三个元素表示了第$i$个三角形的三个顶点的指标．
	\end{enumerate}
\end{defn}







\section{MARS理论框架的基本内容}
\label{sec:MARS}
\subsection{MARS方法的定义}
在界面追踪（IT）问题当中，我们通常得到一个先验的速度场$\mathbf{u}(\mathbf{x},t)$，
每个流体相通过这个速度场推进，对应的常微分方程如下：
\begin{equation}
\label{volEquation}
\frac{\mathrm{d}\, \mathbf{x}}{\mathrm{d}\, t}=\mathbf{u}(\mathbf{x},t),
\end{equation}
若速度场$\mathbf{u}(\mathbf{x},t)$对时间$t$连续，
在空间$\mathbb{R}^{\textup{D}}$上Lipschitz连续，
则其存在唯一解．由解的唯一性可得流映射 $\phi: \mathbb{R}^{\textup{D}}\times \mathbb{R}\times\mathbb{R}\rightarrow \mathbb{R}^{\text{D}}$.
\begin{equation} 
\label{eq:tracing}
\renewcommand{\arraystretch}{1.3}
\left\{
\begin{array}{l}
\phi_{t_0}^{+k}(p) := p(t_0+k) 
= p(t_0) + \int_{t_0}^{t_0+k} \mathbf{u}(p(t),t)\,\mathrm{d}\, t,
\\
\phi_{t_0}^{-k}(p) := p(t_0-k) 
= p(t_0) + \int_{t_0}^{t_0-k} \mathbf{u}(p(t),t)\,\mathrm{d}\,t.
\end{array}
\right.
\end{equation}
将流映射推广到任意点集有：
\begin{displaymath}
\phi_{t_0}^{\pm k}({\mathcal M})  
= \{\phi_{t_0}^{\pm k}(p) : p\in {\mathcal M}\}.
\end{displaymath}
记 $\overleftarrow{M}:=\phi_{t_0+k}^{-k}(M)$, $\overrightarrow{M}:=\phi_{t_0}^{+k}(M)$, 
其中$t_0$表示当前时刻，$k$表示时间步间隔．

\begin{defn}（界面追踪问题）
	\label{defn:ITproblem}
	设$\mathbf{u}(\mathbf{x},t):\mathbb{R}^{\textup{D}} \times[t_0,T] \rightarrow\mathbb{R}^{\text{D}}$对时间$t$连续，
	在空间$\mathbb{R}^{\textup{D}}$上分片Lipschitz连续，
	当给定流相初始时刻$t_0$的位置$\mathcal{M}(t_0)\in \mathbb{Y}$,
	求得流相随流场$\mathbf{u}$输移后在终点时刻$T$的位置$\mathcal{M}(T)\in \mathbb{Y}$，
	这就是界面追踪问题．
\end{defn}
尽管在本文中我们限制了流映射是一个同胚映射，不产生拓扑变化，
但在整个MARS理论中允许流相存在潜在的拓扑变化的，
故对于流速场我们只要求其在空间上是分片连续的．


\begin{defn}
	\label{defn:MARS}
	MARS方法是具有以下形式的界面追踪方法，
	\begin{equation*}
	\label{eq:interfaceTrackingMethod}
	{\mathcal M}^{n+1}={\mathfrak L}_{\mathrm{Mars}}^n {\mathcal M}^n
	:= \left(\chi_{n+1}\circ\varphi_{t_n}^k\circ\psi_n
	\right){\mathcal M}^n.
	\end{equation*}
	其中$\mathcal{M}^n\in\mathbb{Y}$ 是$\mathcal{M}(t_n)\in\mathbb{Y}$的近似，
	$\varphi:\mathbb{Y}\rightarrow
	\mathbb{Y}$ 是式\eqref{eq:tracing}中$\phi$的离散流映射， 
	$\psi_n:\mathbb{Y}\rightarrow \mathbb{Y}$是预处理算子，
	$\chi_{n+1}:\mathbb{Y}\rightarrow \mathbb{Y}$是后处理算子．
\end{defn}

\subsection{MARS方法的误差分析}

\begin{defn}
	一个半离散流映射$\mathring{ \phi} : \mathbb{S}^{\textup{D}}\rightarrow \mathbb{S}^{\textup{D}}$由\eqref{volEquation}对时间进行连续积分后所得，
	是\eqref{eq:tracing}中精确流映射$\phi$在时间上离散化后的近似．
	$\mathring{ \phi}_{t_0}^{nk}$在时间上是$\kappa$阶精度的，
	若对于任意的$p(t_0)\in \mathbb{R}^{\textup{D}}$, $t_0+nk\leq T$，
	有$\phi_{t_0}^{nk}(p)+O(k^{\kappa})$.
\end{defn}
\begin{defn}
	一个离散流映射$\mathring{\varphi} : \mathbb{S}_q^{\textup{D}}\rightarrow\mathbb{S}_q^{\textup{D}}$
	是半离散流映射$\mathring{ \phi}$的近似，由以下两步所得，
	\begin{enumerate}
		\item 把$\mathring{ \phi}$作用到边界$\mathcal{P}$的顶点（$0$-单形）上；
		\item 构造一个$\mathring{ \phi}(\partial\mathcal{P})$的多项式与$\partial \mathcal{P}$同胚．
		当$q=1$时，在二维情况下，边界由相连的直线近似；
		在三维情况下，边界由多个三角平面组成的多面体来近似．
	\end{enumerate}
\end{defn}

\begin{defn}
	考虑一种MARS方法，其中映射操作$\varphi$根据精确的映射$\phi$在时间上离散化后得到$\mathring{ \phi}$,
	再在空间上离散$\mathring{ \phi}$的所得到．
	MARS方法在$t_n=t_0+nk$时刻的
	时间积分误差$E^{\textsf{ODE}}(t_n)$，
	表示误差$E^{\textsf{REP}}(t_n)$,
	扩充误差$E^{\textsf{AUG}}(t_n)$，
	映射误差$E^{\textsf{MAP}}(t_n)$,
	以及调整误差$E^{\textsf{ADJ}}(t_n)$分别如下：
	\begin{equation}\label{defn:error}
	\left\{
	\begin{array}{rl}
	E^{\textsf{ODE}}(t_n) &:= \| \phi_{t_0}^{nk}(\mathcal{M}^0) \oplus \mathring{ \phi}_{t_0}^{nk}(\mathcal{M}^0) \|;\\[0.2cm]
	E^{\textsf{REP}}(t_n) &:= \| \phi_{t_0}^{nk}(\mathcal{M}(t_0)) \oplus  \phi_{t_0}^{nk}(\mathcal{M}^0) \|;\\[0.2cm]
	\varepsilon_i^{\textsf{AUG}} &:=  ( \psi_i \mathcal{M}^i )\oplus \mathcal{M}^i, \\[0.2cm]
	E^{\textsf{AUG}}(t_n) &:= \| \oplus_{j=0}^{n-1} \mathring{ \phi}_{t_j}^{(n-j)k}\varepsilon_j^{\textsf{AUG}} \|;\\[0.2cm]
	\varepsilon_i^{\textsf{MAP}}(t_n)& := \mathring{ \phi}_{t_i}^k(\psi_i\mathcal{M}^i)\oplus \phi_{t_i}^k(\psi_i\mathcal{M}^i),\\[0.2cm]
	E^{\textsf{MAP}}(t_n) &:=  \| \oplus_{j=1}^n \mathring{ \phi}_{t_j}^{(n-j)k}\varepsilon_{j-1}^\textsf{MAP} \|;\\[0.2cm]
	\varepsilon_{i+1}^{\textsf{ADJ}} &:= (\phi_{t_i}^k\psi_i\mathcal{M}^i)\oplus\mathcal{M}^{i+1},\\[0.2cm]
	E^{\textsf{ADJ}}(t_n) &:= \| \oplus_{j=1}^n\mathring{ \phi}_{t_j}^{(n-j)k}\varepsilon_j^{\textsf{ADJ}}\|.\\[0.2cm]
	\end{array}\right.
	\end{equation}
	$\varepsilon_i^{\textsf{AUG}}$, $\varepsilon_i^{\textsf{MAP}}$, $\varepsilon_{i+1}^{\textsf{ADJ}}$称为第$i$个时间步的误差区域．
\end{defn}




这里$E^{\textsf{ODE}}$是用半离散流映射$\mathring{ \phi}$近似精确流映射$\phi$所引起的误差，
$E^{\textsf{REP}}$是在初始时刻用半代数集表示流相的误差，
$E^{\textsf{AUG}}$是扩充半代数集的累计误差，
$E^{\textsf{MAP}}$是用映射操作近似半离散流映射的累计误差，
$E^{\textsf{ADJ}}$是调整半代数集的像的累计误差．

界面追踪方法在任意$t_n$时刻的计算误差定义为：
\begin{equation}
\label{eq:geomError}
E_1(t_n) := \|\mathcal{M}(t_n) \oplus
\mathcal{M}^{n}\| = \sum_{{\mathcal C}\subset \Omega}
\left\|\mathcal{M}_{\mathcal C}(t_n) \oplus
\mathcal{M}_{\mathcal C}^{n}\right\|.
\end{equation}
其中$\mathcal{M}(t_n)$是$t_n$时刻的精确解，$\mathcal{M}^n$是该方法的计算结果．
\begin{thm}
定义\ref{defn:MARS}中的MARS方法是殷空间上的三个算子的复合，
通过\eqref{defn:error}定义的各类单一误差以及对每个算子的分析，
得MARS方法的整体误差满足\cite{zhang16:_mars}：
 \begin{equation}
\label{eq:E1parts}
E_1(t_n)  \le E^{\mathrm{ODE}} + E^{\mathrm{MAP}}
+ E^{\mathrm{REP}} + E^{\mathrm{AUG}} + E^{\mathrm{ADJ}}.
\end{equation}
这里的 $E^{\mathrm{ODE}}$，  $E^{\mathrm{MAP}}$，
$E^{\mathrm{REP}}$ ，$E^{\mathrm{AUG}}$， $E^{\mathrm{ADJ}}$均由\eqref{defn:error}给出． 
\end{thm}

\begin{defn}
	半代数集$\mathcal{P}\in\mathbb{S}_q^{\textup{D}}$的拉格朗日长度尺度
	是所有边的两个端点之间的最大距离，即
	\begin{equation}
	\label{defn:LagrangeLength}
	h_L(\mathcal{P}):= \max_{\widetilde{\mathbf{xy}}\subset\partial\mathcal{P}}d_2(\mathbf{x},\mathbf{y}).
	\end{equation}
	其中$\mathbf{x,y}$是$\mathcal{P}$的顶点（0-单形），
	$\widetilde{\mathbf{xy}}$是$\mathcal{P}$的边（1-单形），
	$d_2(\mathbf{x,y})$是$\mathbf{x}$和$\mathbf{y}$之间的欧拉距离．
\end{defn}
\begin{cor}\label{cor:errorbound}
	如果MARS方法在每一个时间步用线性半代数集表示连续介质，
	用离散流映射作为映射操作,并使用一个$\kappa$阶精度的半离散流映射$\mathring{ \phi}$,
	其中$\kappa>2$,则MARS方法的总体IT误差可以有界为：
	\begin{equation}
	E_1(t_n)\leq E^{\textsf{AUG}}+E^{\textsf{ADJ}}+O(K^{\kappa})+O(h_L^2).
	\end{equation}
	其中$h_L=\max_{j=0}^nh_L(\mathcal{M}^j)$．
\end{cor}


\begin{lem}\label{lem:ADJerror}
	若调整算子$\chi:\mathbb{S}_q^{\textup{D}}\leftarrow\mathbb{S}_q^{\textup{D}}$满足：
	\begin{equation*}
	\forall \mathcal{P}\in\mathbb{S}_q^{\textup{D}},\qquad \|\mathcal{P}\oplus \chi\mathcal{P}\|=O(h_L^2,_{\chi\mathcal{P}}).
	\end{equation*}
	其中$h_L,_{\chi\mathcal{P}}$是$\chi\mathcal{P}$的拉格朗日尺度长度．
	设$\chi$是幂等的，即$\chi\circ\chi=\chi$,且在MARS方法${\mathfrak L}_{\mathrm{Mars}}^n {\mathcal M}^n:= \left(\chi_{n+1}\circ\varphi_{t_n}^k\circ\psi_n
	\right){\mathcal M}^n$满足：
	\begin{equation*}
	\forall n\in \mathbb{N}^+,\qquad \lim_{k\leftarrow0}\psi _n=\mathcal{I},
	\qquad\lim_{k\leftarrow0}\varphi_{t_n}^k\circ\psi_n=\mathcal{I}.
	\end{equation*}
	其中$\mathcal{I}$是恒等算子，
	且$\varphi_{t_n}^k$是一个二阶半离散体的流映射$\mathring{ \phi}_{t_n}^k$．
	则每一个时间步上的调整算子的误差可以表示为:
	\begin{equation*}
	\|\widetilde{\mathcal{M}}^n\oplus\chi\widetilde{\mathcal{M}}^n \|=O(kh_L^2).
	\end{equation*}
	其中$h_L=\max_n h_L(\mathcal{M}^n),\mathcal{M}^n=\chi\widetilde{\mathcal{M}^n}$， 而$\widetilde{\mathcal{M}}^{n+1}:=(\phi_{t_n}^k\circ\psi_n)\mathcal{M}^{n-1}$.
\end{lem}

\begin{defn}
	\label{defn:accuracy}
	如果对定义\ref{defn:ITproblem}中任意$\mathbf{u}(\mathbf{x},t)$, $\mathcal{M}(t_0)\in\mathbb{Y}$和$T>t_0$, 
	界面追踪方法$\mathcal{L}_{\mathrm{IT}}$,
	\begin{equation*}
	\mathcal{M}^{n+1}
	= \mathcal{L}_{\mathrm{IT}}\bigl(\mathcal{M}(t_n), \mathbf{u}\bigr)
	\approx  \mathcal{M}(t_{n+1}),
	\end{equation*}
	被称为具有$\beta$ 阶精度，若其在时间步长$k$足够小的时候均满足$E_1(T)=O(k^{\beta})$ .
\end{defn}